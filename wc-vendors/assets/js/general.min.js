jQuery(function(o) {
  window.Parsley.addValidator('price', {
    validateString: function(e) {
      let n = !0
      var t = wcv_frontend_general.thousand_separator,
        a = wcv_frontend_general.decimal_separator
      let i = wcv_frontend_general.digits_after_decimal,
        r = e.split(a)
      return (
        !(-1 < e.indexOf(t) || 1 < c(e, a)) &&
        (o.each(r, function(e, t) {
          return isNaN(t) ||
            (1 < r.length &&
              e === r.length - 1 &&
              (0 === t.length || t.length > i))
            ? (n = !1)
            : void 0
        }),
        n)
      )
    },
    messages: { en: wcv_frontend_general.invalid_price_format }
  }),
    window.Parsley.addValidator('decimal', {
      validateString: function(e) {
        let n = !0
        let a = e.split('.')
        return (
          !(1 < c(e, '.')) &&
          (o.each(a, function(e, t) {
            return isNaN(t) ||
              (1 < a.length && e === a.length - 1 && 0 === t.length)
              ? (n = !1)
              : void 0
          }),
          n)
        )
      },
      messages: { en: wcv_frontend_general.invalid_number_format }
    })
  let c = function(t, n) {
    let a = 0
    for (let e = 0; e < t.length; e++) t.charAt(e) === n && (a += 1)
    return a
  }
  function e(e, t) {
    o(e).is(':checked')
      ? (t.prop('disabled', !0),
        t.each(function() {
          o(this).is(':checkbox')
            ? o(this).removeAttr('checked')
            : o(this).val('')
        }))
      : t.prop('disabled', !1)
  }
  o('.wcv-img-id').each(function() {
    let t = this.id
    o('.wcv-file-uploader-add' + t).on('click', function(e) {
      e.preventDefault()
      {
        var r = t
        let a = o('#' + r),
          i = a.data('type'),
          e = ''
        if ('undefined' != typeof wp && void 0 !== wp.media) {
          'document' === i ? (e = 'application') : 'input' !== i && (e = i)
          let n = wp.media({
            title: a.data('window_title'),
            button: { text: a.data('save_button') },
            library: { type: e },
            multiple: !1
          })
          n.on('select', function() {
            var e,
              t = n
                .state()
                .get('selection')
                .first()
                .toJSON()
            o.trim(t.url.length) < 0 ||
              (a.val(t.id).change(),
              o('.wcv-file-uploader-add' + r).addClass('hidden'),
              o('.wcv-file-uploader-delete' + r).removeClass('hidden'),
              'image' === i
                ? ((e = (t.sizes.thumbnail || t).url),
                  (e = o('<img>')
                    .attr('src', e)
                    .attr('alt', t.caption || '')
                    .attr('title', t.title || '')
                    .css('max-width', '100%')
                    .css('margin-bottom', '16px')),
                  o('.wcv-file-uploader' + r).append(e))
                : 'video' === i || 'audio' === i || 'document' === i
                ? ((e = {
                    action: 'wcv_file_uploader_preview',
                    file_url: t.url
                  }),
                  o.post(wcv_frontend_general.ajax_url, e, function(e) {
                    o('.wcv-file-uploader' + r).append(e)
                  }))
                : o('.wcv-file-uploader' + r).append(
                    '<div class="control-group"><div class="control"><input type="text" value="' +
                      t.url +
                      '" readonly/></div></div>'
                  ))
          }),
            n.open()
        }
      }
      return !1
    }),
      o('.wcv-file-uploader-delete' + t).on('click', function(e) {
        e.preventDefault(),
          o('.wcv-file-uploader' + t).html(''),
          o('input[id=' + t + ']').val(''),
          o('.wcv-file-uploader-delete' + t).addClass('hidden'),
          o('.wcv-file-uploader-reset' + t).addClass('hidden'),
          o('.wcv-file-uploader-add' + t).removeClass('hidden')
      })
  }),
    o('select#_wcv_shipping_from')
      .on('change', function() {
        'other' === o(this).val()
          ? o('.shipping_other').show()
          : o('.shipping_other').hide()
      })
      .trigger('change'),
    o('#_wcv_shipping_fee_national_free').on('change', function() {
      e(o(this), o('#_wcv_shipping_fee_national'))
    }),
    o('#_wcv_shipping_fee_national_disable').on('change', function() {
      e(o(this), o('.wcv-disable-national-input'))
    }),
    o('#_wcv_shipping_fee_international_free').on('change', function() {
      e(o(this), o('#_wcv_shipping_fee_international'))
    }),
    o('#_wcv_shipping_fee_international_disable').on('change', function() {
      e(o(this), o('.wcv-disable-international-input'))
    }),
    'other' === o('#_wcv_shipping_from').val()
      ? o('.shipping_other').show()
      : o('.shipping_other').hide(),
    o('.wcv-vacaction-mode').on('change', function() {
      o('.wcv-vacation-mode-msg-wrapper').slideToggle()
    }),
    o('.wcv-vacaction-mode').is(':checked') &&
      o('.wcv-vacation-mode-msg-wrapper').show(),
    o('.wcv-ga-enable').on('change', function() {
      o('.wcv-ga-id-value-wrapper').slideToggle()
    }),
    o('.wcv-ga-enable').is(':checked')
      ? o('.wcv-ga-id-value-wrapper').slideToggle()
      : o('.wcv-ga-id-value-wrapper').hide(),
    o('.wcv-enable-opening-hours').on('change', function() {
      o('.wcv-opening-hours-wrapper').slideToggle()
    }),
    o('.wcv-enable-opening-hours').is(':checked')
      ? o('.wcv-opening-hours-wrapper').show()
      : o('.wcv-opening-hours-wrapper').hide(),
    o('#store_save_button').on('click', function(e) {
      e.preventDefault()
      e = {
        action: 'wcv_json_unique_store_name',
        store_name: o('#_wcv_store_name').val(),
        security: wcv_frontend_general.wcv_json_unique_store_name_nonce
      }
      o.post(wcv_frontend_general.ajax_url, e, function(e) {
        if (e.error) return window.alert(e.error), !1
        o('#wcv-store-settings').submit()
      })
    }),
    o('.wcv-form').parsley({
      trigger: 'input',
      excluded:
        '.is_hidden, input[type=button], input[type=submit], input[type=reset], input[type=hidden], [disabled]',
      classHandler: function(e) {
        return e.$element.hasClass('wcv_category_check')
          ? e.$element.closest('.wcv_terms_checklist_container')
          : e.$element.hasClass('select2-hidden-accessible')
          ? e.$element.parent().find('.select2-selection')
          : e.$element.hasClass('wcv-datepicker')
          ? e.$element.closest('.wcv-datepicker-wrapper')
          : e
      },
      errorsContainer: function(e) {
        return e.$element.hasClass('wcv_category_check')
          ? e.$element.closest('.wcv_terms_checklist_container').parent()
          : e.$element.hasClass('select2-hidden-accessible')
          ? e.$element.parent()
          : e.$element.hasClass('wcv-datepicker')
          ? e.$element.closest('.control-group')
          : e
      }
    }),
    window.Parsley.on('field:error', function() {
      var e = this.$element.closest('.tabs-content').attr('id')
      o('.wcv-tabs')
        .find('.' + e)
        .addClass('tab-has-error')
    }),
    window.Parsley.on('field:success', function() {
      var e = this.$element.closest('.tabs-content')
      0 < e.find('.parsley-error').length ||
        ((e = e.attr('id')),
        o('.wcv-tabs')
          .find('.' + e)
          .removeClass('tab-has-error'))
    }),
    'hidden' === Cookies.get('vendor_store_notice')
      ? o('.woocommerce-store-notice').hide()
      : o('.woocommerce-store-notice').show(),
    o('#clear_button').on('click', function(e) {
      e.preventDefault()
      var e = o('#_wcv_order_start_date_input'),
        t = o('#_wcv_order_end_date_input')
      e.val(e.data('default')),
        t.val(t.data('default')),
        o('#_wcv_shipping_status_input').val(''),
        o('#_wcv_order_status_input').val(''),
        o('#wcv_order_search_input').val(''),
        o('#wcv_order_search_filter').val('all'),
        o('.wcv-order-header .wcv-form').trigger('submit')
    }),
    o('#clear_button_commission').on('click', function(e) {
      e.preventDefault()
      var e = o('#_wcv_commission_start_date_input'),
        t = o('#_wcv_commission_end_date_input')
      e.val(e.data('default')),
        t.val(t.data('default')),
        o('.wcv-commission-header .wcv-form').trigger('submit')
    }),
    o('#clear_button_report').on('click', function(e) {
      e.preventDefault()
      var e = o('#_wcv_dashboard_start_date_input'),
        t = o('#_wcv_dashboard_end_date_input')
      e.val(e.data('default')),
        t.val(t.data('default')),
        o('.wcv-form').trigger('submit')
    }),
    o('#clear_button_product').on('click', function(e) {
      e.preventDefault(),
        o('#_wcv_product_category').val(''),
        o('#_wcv_product_tag').val(''),
        o('#_wcv_product_type').val(''),
        o('#wcv-search').val(''),
        o('.wcv-form').trigger('submit')
    }),
    o('select#wcv_paypal_masspay_wallet')
      .on('change', function() {
        'venmo' === o(this).val()
          ? o('.wcv_paypal_masspay_venmo_id').show()
          : o('.wcv_paypal_masspay_venmo_id').hide()
      })
      .trigger('change')
})
