jQuery(function(p) {
  p(document).ready(function() {
    function t() {
      var e;
      for (e of document.querySelectorAll('.wcv-accordion-title')) {
        var a = e.parentNode,
          i = a.querySelector('.tabs-content').children,
          o = i.length;
        let t = 0;
        Array.from(i).forEach(e => {
          ('none' !== e.style.display && 0 != e.children.length) || t++;
        }),
          t === o
            ? ((a.style.display = 'none'), a.classList.add('hide-all'))
            : (e.classList.remove('is_hidden'),
              a.classList.remove('is_hidden'),
              a.classList.remove('hide-all'));
      }
    }
    function a() {
      var e = p('#product-type').val(),
        t = p('#_virtual').is(':checkbox')
          ? p('input#_virtual:checked').length
          : p('#_virtual').val(),
        a = p('#_downloadable').is(':checkbox')
          ? p('input#_downloadable:checked').length
          : p('#_downloadable').val(),
        i = '.hide_if_downloadable, .hide_if_virtual',
        o =
          '.show_if_downloadable, .show_if_virtual, .show_if_external, .show_if_booking',
        a =
          (p.each(wcv_frontend_product.product_types, function(e, t) {
            (i = i + ', .hide_if_' + t), (o = o + ', .show_if_' + t);
          }),
          p(i)
            .show()
            .removeClass('is_hidden'),
          p(i)
            .find('input')
            .removeClass('is_hidden'),
          p(o)
            .hide()
            .addClass('is_hidden'),
          p(o)
            .find('input')
            .addClass('is_hidden'),
          a &&
            (p('.show_if_downloadable')
              .show()
              .removeClass('is_hidden'),
            p('.show_if_downloadable')
              .find('input')
              .removeClass('is_hidden')),
          t &&
            (p('.show_if_virtual')
              .show()
              .removeClass('is_hidden'),
            p('.show_if_virtual')
              .find('input')
              .removeClass('is_hidden'),
            p('ul.tabs-nav li').removeClass('active')),
          p('.show_if_' + e)
            .show()
            .removeClass('is_hidden'),
          p('.show_if_' + e)
            .find('input')
            .removeClass('is_hidden'),
          a &&
            (p('.hide_if_downloadable')
              .hide()
              .addClass('is_hidden'),
            p('.hide_if_downloadable')
              .find('input')
              .addClass('is_hidden')),
          t &&
            (p('.hide_if_virtual')
              .hide()
              .addClass('is_hidden'),
            p('.hide_if_virtual')
              .find('input')
              .addClass('is_hidden')),
          'grouped' == e &&
            (p('.linked_product')
              .parent()
              .addClass('active'),
            p('#linked_product')
              .removeClass('hide-all')
              .addClass('active')),
          p('.hide_if_' + e)
            .hide()
            .addClass('is_hidden'),
          p('.hide_if_' + e)
            .find('input')
            .addClass('is_hidden'),
          p('input#_manage_stock').trigger('change'),
          wcv_frontend_product.is_demensions_required);
      a && t
        ? p('input#_length, input#_width, input#_height').prop('required', !1)
        : a &&
          p('input#_length, input#_width, input#_height').prop('required', !0),
        !jQuery('.wcv-form').length ||
          jQuery('.wcv-search-form').length ||
          p('.wcv-form').hasClass('wcv-form-exclude') ||
          p('.wcv-form')
            .parsley()
            .reset();
    }
    function i() {
      var t,
        e = p('.wcv-featuredimg').data('title'),
        a = p('.wcv-featuredimg').data('button_text'),
        i = wp.media({ title: e, button: { text: a }, multiple: !1 });
      i.on('select', function() {
        var e;
        (t = i
          .state()
          .get('selection')
          .first()
          .toJSON()),
          p.trim(t.url.length) < 0 ||
            ((e = (t.sizes.thumbnail || t).url),
            p('.wcv-featuredimg')
              .find('img')
              .remove(),
            p('.wcv-featuredimg').prepend(
              '<img src="' +
                e +
                '" alt="' +
                t.caption +
                '" title="' +
                t.title +
                '" style="max-width: 100%;" />'
            ),
            p('.wcv-featuredimg').addClass('has-image'),
            p('#_featured_image_id').val(t.id),
            p('.wcv_featured_image_msg').html(''),
            p('.wcv-media-uploader-featured-replace').removeClass('hidden'),
            p('.wcv-media-uploader-featured-delete').removeClass('hidden'),
            p('.product-feat-image-upload .file-upload-wrapper').addClass(
              'hidden'
            ));
      }),
        i.open();
    }
    function o() {
      var e,
        i = p('#product_image_gallery'),
        o = p('#product_images_container ul.product_images'),
        r = i.val(),
        n = p('#product_images_container').data('gallery_max_upload'),
        l = p('#product_images_container').data('gallery_max_selected_notice'),
        d = (wp.media.frames.file_frame = wp.media({
          title: 'Choose or Upload Images',
          button: { text: 'Use Image(s)' },
          library: { type: 'image' },
          multiple: !0
        }));
      d.on('select', function() {
        var t,
          e = d.state().get('selection'),
          a = (p('.max-gallery-images-exceeded-warning').remove(), 0);
        e.map(function(e) {
          (e = e.toJSON()).id &&
            !s() &&
            ((r = r ? r + ',' + e.id : e.id),
            (t = (e.sizes.thumbnail || e).url),
            o
              .find('.file-upload-wrapper')
              .before(
                '<li class="wcv-gallery-image" data-attachment_id="' +
                  e.id +
                  '"><img src="' +
                  t +
                  '" /><ul class="actions"><li><a href="#" class="delete" title="Delete image"><svg class="wcv-icon wcv-icon-md"><use xlink:href="' +
                  wcv_frontend_product.assets_url +
                  'svg/wcv-icons.svg#wcv-icon-times"></use></svg></a></li></ul></li>'
              ),
            p('.wcv_gallery_msg').html('')),
            a++;
        }),
          i.val(r),
          n < a &&
            ((e =
              '<div class="max-gallery-images-exceeded-warning">' +
              l +
              '</div>'),
            p('#product_images_container').append(e));
      }),
        d.on('close', function() {
          p('.attachment.selected').removeClass('selected');
        }),
        s()
          ? ((e = p('#product_images_container').data('gallery_max_notice')),
            alert(e))
          : d.open();
    }
    var r, n, l, d;
    function s() {
      var e = p('.wcv-gallery-image').length;
      return p('#product_images_container').data('gallery_max_upload') - 1 < e;
    }
    function e(e, t) {
      p(e).is(':checked')
        ? (t.prop('disabled', !0),
          t.each(function() {
            p(this).is(':checkbox')
              ? p(this).removeAttr('checked')
              : p(this).val('');
          }))
        : t.prop('disabled', !1);
    }
    t(),
      p('select#product-type')
        .on('change', function() {
          var e = p(this).val();
          document
            .getElementById('product-meta-accordion')
            .setAttribute('data-type', e),
            'variable' === e
              ? (p('input#_manage_stock').trigger('change'),
                p('input#_downloadable').prop('checked', !1),
                p('input#_virtual').removeAttr('checked'))
              : ('grouped' !== e && 'external' !== e) ||
                (p('input#_downloadable').prop('checked', !1),
                p('input#_virtual').removeAttr('checked')),
            a(),
            t();
          {
            let t = document.getElementById('product-meta-accordion');
            t &&
              requestAnimationFrame(() => {
                var e;
                for (e of t.querySelectorAll('.wcv-accordion-title'))
                  if (0 < e.offsetWidth && 0 < e.offsetHeight) {
                    e.classList.contains('active') || e.click();
                    break;
                  }
              });
          }
          p('body').trigger('woocommerce-product-type-change', e, p(this)),
            p('.wcv-tabs')
              .find('select.select2')
              .select2();
        })
        .trigger('change'),
      p('input#_downloadable, input#_virtual').on('change', function() {
        a();
      }),
      p('.sale_price_dates_fields').each(function() {
        var e = !1;
        p('.sale_price_dates_fields')
          .find('input')
          .each(function() {
            '' != p(this).val() && (e = !0);
          }),
          e
            ? (p('.sale_schedule').hide(), p('.sale_price_dates_fields').show())
            : (p('.sale_schedule').show(),
              p('.sale_price_dates_fields').hide());
      }),
      p('.sale_schedule').on('click', function() {
        return (
          p('.sale_price_dates_fields').show(),
          p(this).hide(),
          p('.cancel_sale_schedule').show(),
          !1
        );
      }),
      p('.cancel_sale_schedule').on('click', function() {
        return (
          p('.sale_price_dates_fields').hide(),
          p(this).hide(),
          p('.sale_schedule').show(),
          !1
        );
      }),
      p('input#_manage_stock')
        .on('change', function() {
          var e;
          p(this).is(':checked')
            ? (p('div.stock_fields')
                .show()
                .removeClass('is_hidden'),
              p('div.stock_fields')
                .find('input')
                .removeClass('is_hidden'),
              p('.stock_status_field').hide())
            : ((e = p('select#product-type').val()),
              p('div.stock_fields')
                .hide()
                .addClass('is_hidden'),
              p('div.stock_fields')
                .find('input')
                .addClass('is_hidden'),
              p('.stock_status_field:not( .hide_if_' + e + ' )').show()),
            p('.wcv-form').hasClass('wcv-form-exclude') ||
              p('.wcv-form')
                .parsley()
                .reset();
        })
        .change(),
      p('.wcv-media-uploader-featured-delete').on('click', function(e) {
        e.preventDefault(),
          p('.wcv-featuredimg')
            .find('img')
            .remove(),
          p('.wcv-featuredimg').removeClass('has-image'),
          p('#_featured_image_id').val(''),
          p('.wcv-media-uploader-featured-delete').addClass('hidden'),
          p('.wcv-media-uploader-featured-replace').addClass('hidden'),
          p('.product-feat-image-upload .file-upload-wrapper').removeClass(
            'hidden'
          );
      }),
      p('.wcv-media-uploader-featured-replace').on('click', function() {
        return i(), !1;
      }),
      p(document).on('click', '.attachment', function() {
        var e = p('.attachment.selected').length,
          t = p('#product_images_container').data('gallery_max_upload'),
          a = p('#product_images_container').data(
            'gallery_max_selected_notice'
          );
        t < e &&
          (p('.max-gallery-selected-warning').remove(),
          p(
            '.media-frame-toolbar .media-toolbar .media-toolbar-secondary'
          ).prepend(
            '<div class="woocommerce-info max-gallery-selected-warning">' +
              a +
              '</div>'
          ),
          p('.media-button-select').attr('disabled', !0)),
          e <= t &&
            (p('.max-gallery-selected-warning').remove(),
            p('.media-button-select').attr('disabled', !1));
      }),
      document.getElementById('product_images') &&
        new MutationObserver(function(e) {
          e.forEach(function(e) {
            var t;
            (0 < e.addedNodes.length || 0 < e.removedNodes.length) &&
              ((t = p('#product_images').children().length),
              p('#product_images_container').data('gallery_max_upload') < t
                ? p('.product-imgs-gallery-upload')
                    .find('.file-upload-wrapper')
                    .addClass('hide-all')
                : p('.product-imgs-gallery-upload')
                    .find('.file-upload-wrapper')
                    .removeClass('hide-all'),
              1 < t
                ? (p(
                    '.product-imgs-gallery-upload .wcv-upload-files-input'
                  ).addClass('small'),
                  e.target.classList.add('has-images'))
                : (p(
                    '.product-imgs-gallery-upload .wcv-upload-files-input'
                  ).removeClass('small'),
                  e.target.classList.remove('has-images')));
          });
        }).observe(document.getElementById('product_images'), {
          childList: !0
        }),
      p('#product_images_container').on('click', 'a.delete', function(e) {
        var t = p('#product_image_gallery'),
          a =
            (e.preventDefault(),
            p(this)
              .closest('li.wcv-gallery-image')
              .remove(),
            ''),
          e =
            (p('#product_images_container ul li.wcv-gallery-image')
              .css('cursor', 'default')
              .each(function() {
                var e = jQuery(this).attr('data-attachment_id');
                a = a + e + ',';
              }),
            (a = a.replace(/,\s*$/, '')),
            t.val(a),
            p('#tiptip_holder').removeAttr('style'),
            p('#tiptip_arrow').removeAttr('style'),
            t.val().split(',').length);
        return (
          e < p('#product_images_container').data('gallery_max_upload') &&
            p('.product-imgs-gallery-upload')
              .find('.file-upload-wrapper')
              .removeClass('hidden'),
          !1
        );
      }),
      p('.product-imgs-gallery-upload .wcv-browser-file').on('click', function(
        e
      ) {
        return e.preventDefault(), o(), !1;
      }),
      p('#files_download').on(
        'click',
        '.downloadable_files a.insert',
        function() {
          return (
            p(this)
              .closest('.downloadable_files')
              .find('tbody')
              .append(p(this).data('row')),
            !1
          );
        }
      ),
      p('#files_download').on(
        'click',
        '.downloadable_files a.delete',
        function() {
          return (
            p(this)
              .closest('tr')
              .remove(),
            !1
          );
        }
      ),
      p(document).on('change', '.file_display', function(e) {
        e.preventDefault();
        var e = p(this),
          e = ((n = e.closest('tr').find('.file_url')), e.val()),
          t = wcv_frontend_product.mime_types.join('|'),
          t = new RegExp(`^.*.(${t})$`, 'gm');
        e &&
          'file_url' !== wcv_frontend_product.wcv_file_display &&
          t.test(e) &&
          n.val(e);
      }),
      p(document).on('click', '.upload_file_button', function(e) {
        var t = p(this);
        (n = t.closest('tr').find('.file_url')),
          (l = t.closest('tr').find('.file_id')),
          (d = t.closest('tr').find('.file_display')),
          e.preventDefault(),
          r ||
            ((e = [
              new wp.media.controller.Library({
                library: wp.media.query(),
                multiple: !0,
                title: t.data('choose'),
                priority: 20,
                filterable: 'uploaded'
              })
            ]),
            (r = wp.media.frames.downloadable_file = wp.media({
              title: t.data('choose'),
              library: { type: '' },
              button: { text: t.data('update') },
              multiple: !0,
              states: e
            })).on('select', function() {
              var t = '',
                a = '',
                i = 0;
              r
                .state()
                .get('selection')
                .map(function(e) {
                  (a =
                    'file_url' == wcv_frontend_product.wcv_file_display
                      ? e.attributes.url
                      : e.attributes.filename),
                    (e = e.toJSON()).url && (t = e.url),
                    e.id && (i = e.id);
                }),
                n.val(t),
                d.val(a),
                l.val(i);
            }),
            r.on('ready', function() {
              r.uploader.options.uploader.params = {
                type: 'downloadable_product'
              };
            })),
          r.open();
      }),
      p('.downloadable_files tbody').sortable({
        items: 'tr',
        cursor: 'move',
        axis: 'y',
        handle: 'td.sort',
        scrollSensitivity: 40,
        forcePlaceholderSize: !0,
        helper: 'clone',
        opacity: 0.65
      }),
      p('#_shipping_fee_national_disable').change(function() {
        e(p(this), p('.wcv-disable-national-input'));
      }),
      p('#_shipping_fee_national_free').on('change', function() {
        e(p(this), p('#_shipping_fee_national')),
          e(p(this), p('#_national_minimum_shipping_fee')),
          e(p(this), p('#_national_maximum_shipping_fee')),
          e(p(this), p('#_national_free_shipping_product'));
      }),
      p('#_shipping_fee_international_disable').on('change', function() {
        e(p(this), p('.wcv-disable-international-input'));
      }),
      p('#_shipping_fee_international_free').on('change', function() {
        e(p(this), p('#_shipping_fee_international')),
          e(p(this), p('#_international_minimum_shipping_fee')),
          e(p(this), p('#_international_maximum_shipping_fee')),
          e(p(this), p('#_international_free_shipping_product'));
      }),
      p('#shipping').on('click', '.wcv_shipping_rates a.insert', function() {
        var e = p('#wcv_shipping_rates_table tbody tr').length,
          t = (t = p(this)
            .data('row')
            .replace(
              'id="_wcv_shipping_overrides_"',
              'id="_wcv_shipping_overrides_' + e + '"'
            )).replace(
            'name="_wcv_shipping_overrides_"',
            'name="_wcv_shipping_overrides_' + e + '"'
          );
        return (
          p(this)
            .closest('.wcv_shipping_rates')
            .find('tbody')
            .append(t)
            .find('select')
            .select2({ placeholderOption: 'first', width: '100%' }),
          !1
        );
      }),
      p('#shipping').on('click', '.wcv_shipping_rates a.delete', function() {
        return (
          p(this)
            .closest('tr')
            .remove(),
          !1
        );
      }),
      p('.wcv_shipping_rates tbody').sortable({
        items: 'tr',
        cursor: 'move',
        axis: 'y',
        handle: 'td.sort',
        scrollSensitivity: 40,
        forcePlaceholderSize: !0,
        helper: 'clone',
        opacity: 0.65
      }),
      p('.category-select2').select2({
        maximumSelectionLength: wcv_frontend_product.category_limit,
        language: {
          maximumSelected: function(e) {
            return 1 != e.maximum
              ? wcv_frontend_product.select2_maximumSelected_plural
              : wcv_frontend_product.select2_maximumSelected_single;
          },
          loadingMore: function() {
            return wcv_frontend_product.select2_loadingMore;
          },
          errorLoading: function() {
            return wcv_frontend_product.select2_errorLoading;
          },
          noResults: function() {
            return wcv_frontend_product.select2_noResults;
          },
          searching: function() {
            return wcv_frontend_product.select2_searching;
          },
          removeAllItems: function() {
            return wcv_frontend_product.select2_removeAllItems;
          }
        }
      }),
      a(),
      e(p('#_shipping_fee_national_free'), p('#_shipping_fee_national')),
      e(
        p('#_shipping_fee_international_free'),
        p('#_shipping_fee_international')
      ),
      e(p('#_shipping_fee_national_disable'), p('.wcv-disable-national-input')),
      e(
        p('#_shipping_fee_international_disable'),
        p('.wcv-disable-international-input')
      ),
      p('.confirm_delete').on('click', function(e) {
        confirm(p(this).data('confirm_text')) || e.preventDefault();
      });
    var c = p('.product_attributes')
        .find('.woocommerce_attribute')
        .get(),
      u =
        (c.sort(function(e, t) {
          (e = parseInt(p(e).attr('rel'), 10)),
            (t = parseInt(p(t).attr('rel'), 10));
          return e < t ? -1 : t < e ? 1 : 0;
        }),
        p(c).each(function(e, t) {
          p('.product_attributes').append(t);
        }),
        p('.product_attributes .woocommerce_attribute').each(function(e, t) {
          'none' !== p(t).css('display') &&
            p(t).is('.taxonomy') &&
            p('select.attribute_taxonomy')
              .find('option[value="' + p(t).data('taxonomy') + '"]')
              .attr('disabled', 'disabled');
        }),
        p('.wcv_product_attributes')
          .on('click', '.wcv-metabox .wcv-attr-header', function(e) {
            p(e.target).filter(':input, option, .sort').length ||
              (p(this)
                .next('.wcv-metabox-content')
                .stop()
                .slideToggle(),
              p(this)
                .closest('.wcv-metabox')
                .toggleClass('closed'),
              0 <
                (e = p(this)
                  .siblings('.wcv_attribute_data')
                  .find('select')).length &&
                !e.hasClass('select2-hidden-accessible') &&
                e.select2());
          })
          .on('click', '.expand_all', function() {
            return (
              p(this)
                .closest('.wcv_product_attributes')
                .find('.wcv-metabox')
                .removeClass('closed')
                .find('.wcv-metabox-content')
                .slideDown(),
              !1
            );
          })
          .on('click', '.close_all', function() {
            return (
              p(this)
                .closest('.wcv_product_attributes')
                .find('.wcv-metabox')
                .addClass('closed')
                .find('.wcv-metabox-content')
                .slideUp(),
              !1
            );
          }),
        p('.wcv-metabox.closed').each(function() {
          p(this)
            .find('.wcv-metabox-content')
            .hide();
        }),
        p(function() {
          function l(e) {
            var t = p('#wcv-variation-attributes').data('variation_attr');
            jQuery.isEmptyObject(t) ||
              (delete t[e],
              p('#wcv-variation-attributes').data('variation_attr', t));
          }
          function o(e, t, a) {
            var i,
              o = {},
              r = e.parent().data('taxonomy'),
              n = e.parent().data('index_value');
            p('#attribute_variation_' + n).is(':checked') &&
              (e.is('input')
                ? ((i = e.val().split(wcv_frontend_product.wc_deliminator)),
                  p.each(i, function(e, t) {
                    0 < p.trim(t).length &&
                      (o[p.trim(t).toLowerCase()] = p.trim(t));
                  }))
                : (e.select2(),
                  (i = e.select2('data')),
                  p.each(i, function(e, t) {
                    o[t.id] = t.text;
                  }))),
              jQuery.isEmptyObject(o)
                ? l(r)
                : ((n = o),
                  (e = r),
                  (i = t),
                  (r = a),
                  (t = p('#wcv-variation-attributes').data('variation_attr')),
                  jQuery.isEmptyObject(t) && (t = {}),
                  ((a = {}).values = n),
                  (a.position = i),
                  (a.name = e),
                  (a.label = r),
                  (t[e] = a),
                  p('#wcv-variation-attributes').data('variation_attr', t),
                  p('.wcv_single_add_variation').removeClass('hide-all'));
          }
          function n() {
            p('.product_attributes .woocommerce_attribute').each(function(
              e,
              t
            ) {
              p('.attribute_position', t).val(
                parseInt(
                  p(t).index('.product_attributes .woocommerce_attribute'),
                  10
                )
              );
              var a = p(this).data('index_value'),
                a =
                  ((t = p('#attribute_values_' + a)),
                  p('#attribute_position_' + a).val());
              o(t, a, p(this).data('label'));
            });
          }
          p('select.attribute_taxonomy').on('change', function() {
            let e = p('.product_attributes .woocommerce_attribute').length,
              t = p(this).val(),
              a = p('.wcv_product_attributes');
            var i, o, r;
            if (
              (a.block({
                message: null,
                overlayCSS: { background: '#fff', opacity: 0.6 }
              }),
              t)
            )
              return (
                (i = p('.product_attributes')),
                (o = p('#product-type').val()),
                (r = {
                  action: 'wcv_json_add_attribute',
                  taxonomy: t,
                  i: e,
                  security: wcv_frontend_product.wcv_add_attribute_nonce
                }),
                p.post(wcv_frontend_product.ajax_url, r, function(e) {
                  e.error
                    ? window.alert(e.error)
                    : (i.append(e),
                      i
                        .find('.woocommerce_attribute:last .wcv-attr-header')
                        .click(),
                      p('select.attribute_values')
                        .filter(':not(.select12-hidden-accessible)')
                        .select2(),
                      'variable' !== o && i.find('.enable_variation').hide(),
                      p(document.body).trigger('wc-enhanced-select-init'),
                      n(),
                      p(document.body).trigger('woocommerce_added_attribute')),
                    a.unblock();
                }),
                t &&
                  (p('select.attribute_taxonomy')
                    .find('option[value="' + t + '"]')
                    .attr('disabled', 'disabled'),
                  p('select.attribute_taxonomy').val('')),
                !1
              );
          }),
            p('.product_attributes').on(
              'click',
              'button.select_all_attributes',
              function() {
                var e = p(this)
                  .parent()
                  .data('index_value');
                return (
                  p('#attribute_values_' + e + ' > option').prop(
                    'selected',
                    'selected'
                  ),
                  p('#attribute_values_' + e).trigger('change'),
                  u(),
                  !1
                );
              }
            ),
            p('.product_attributes').on(
              'click',
              'button.select_no_attributes',
              function() {
                var e = p(this)
                    .parent()
                    .data('index_value'),
                  t = p(this)
                    .parent()
                    .data('taxonomy');
                return (
                  p('#attribute_values_' + e + ' > option').removeAttr(
                    'selected'
                  ),
                  p('#attribute_values_' + e).trigger('change'),
                  p('#attribute_variation_' + e).is(':checked') && l(t),
                  u(),
                  !1
                );
              }
            ),
            p('.product_attributes').on(
              'change',
              '.attribute_values',
              function() {
                var e = p(this)
                    .parent()
                    .data('index_value'),
                  e = p('#attribute_position_' + e).val(),
                  t = p(this)
                    .closest('.woocommerce_attribute')
                    .data('label');
                u(), o(p(this), e, t);
              }
            ),
            p('.product_attributes').on(
              'change',
              '.wcv_variation_checkbox',
              function() {
                var e = p(this)
                    .closest('.woocommerce_attribute')
                    .data('index_value'),
                  t = p(this)
                    .closest('.woocommerce_attribute')
                    .data('taxonomy'),
                  a = p(this)
                    .closest('.woocommerce_attribute')
                    .data('label'),
                  i = p('#attribute_position_' + e).val(),
                  e = p('#attribute_values_' + e);
                p(this).is(':checked')
                  ? (o(e, i, a),
                    p(document.body).trigger('woocommerce_added_attribute'))
                  : (l(t),
                    p(document.body).trigger('woocommerce_removed_attribute'));
              }
            ),
            p('.product_attributes').on('click', '.remove_row', function() {
              var e;
              return (
                window.confirm(wcv_frontend_product.remove_attribute) &&
                  ((e = p(this).closest('.woocommerce_attribute')).is(
                    '.taxonomy'
                  )
                    ? (e.find('select, input[type=text]').val(''),
                      e.hide(),
                      p('.attribute_taxonomy')
                        .find('option[value="' + e.data('taxonomy') + '"]')
                        .removeAttr('disabled'))
                    : (e.find('select, input[type=text]').val(''),
                      e.hide(),
                      n()),
                  l(e.data('taxonomy')),
                  u(),
                  p(document.body).trigger('woocommerce_removed_attribute')),
                !1
              );
            }),
            p('.product_attributes').sortable({
              items: '.woocommerce_attribute',
              cursor: 'move',
              axis: 'y',
              handle: 'h5',
              scrollSensitivity: 40,
              forcePlaceholderSize: !0,
              helper: 'clone',
              opacity: 0.65,
              placeholder: 'wcv-metabox-sortable-placeholder',
              start: function(e, t) {
                t.item.css('background-color', '#f6f6f6');
              },
              stop: function(e, t) {
                t.item.data('index_value');
                t.item.removeAttr('style'), n();
              }
            }),
            n(),
            p('.attribute_values').each(function() {
              var e = p(this)
                  .parent()
                  .data('index_value'),
                e = p('#attribute_position_' + e).val(),
                t = p(this)
                  .closest('.woocommerce_attribute')
                  .data('label');
              o(p(this), e, t);
            });
        }),
        p('.product_attributes').on(
          'click',
          'button.add_new_attribute',
          function() {
            p('.product_attributes').block({
              message: null,
              overlayCSS: { background: '#fff', opacity: 0.6 }
            });
            var e = p(this)
                .parent()
                .data('index_value'),
              t = p('#attribute_values_' + e),
              e = p(this)
                .parent()
                .data('taxonomy'),
              a = window.prompt(wcv_frontend_product.new_attribute_prompt);
            return (
              a
                ? ((e = {
                    action: 'wcv_json_add_new_attribute',
                    taxonomy: e,
                    term: a,
                    security: wcv_frontend_product.wcv_add_attribute_nonce
                  }),
                  p.post(wcv_frontend_product.ajax_url, e, function(e) {
                    e.error
                      ? window.alert(e.error)
                      : e.slug &&
                        (t.append(
                          p('<option />')
                            .attr('value', e.slug)
                            .prop('selected', 'selected')
                            .text(e.name)
                        ),
                        t.trigger('change'),
                        p(t)
                          .select2('destroy')
                          .select2()),
                      p('.product_attributes').unblock();
                  }))
                : p('.product_attributes').unblock(),
              !1
            );
          }
        ),
        window.Parsley.on('form:submit', function() {
          return u();
        }),
        p('#wcv-product-edit').on('submit', function(e) {
          if (
            (1 == wcv_frontend_product.require_featured_image &&
              '' === p('#_featured_image_id').val() &&
              (p('.wcv_featured_image_msg').html(
                wcv_frontend_product.require_featured_image_msg
              ),
              e.preventDefault()),
            1 == wcv_frontend_product.require_gallery_image &&
              '' === p('#product_image_gallery').val() &&
              (p('.wcv_gallery_msg').html(
                wcv_frontend_product.require_gallery_image_msg
              ),
              e.preventDefault()),
            1 == wcv_frontend_product.require_download_file)
          ) {
            var t = p('.download_file_table'),
              a = t.length,
              i = !0;
            if (!p('#_downloadable').is(':checked')) return;
            p('.downloadable_files').length &&
              (0 == t.find('.download_file').length && (i = !1),
              0 < a
                ? p('.download_file').each(function() {
                    ('' !==
                      p(this)
                        .find('td.file_name')
                        .find('input')
                        .val() &&
                      '' !==
                        p(this)
                          .find('td.file_url')
                          .find('input')
                          .val()) ||
                      (i = !1);
                  })
                : (i = !1),
              i ||
                (p('.downloadable_files').append(
                  '<span class="wcv_required_form_msg">' +
                    wcv_frontend_product.require_download_file_msg +
                    '</span>'
                ),
                p('.download_file_table').css({
                  color: '#b94a48',
                  'background-color': '#f2dede',
                  border: '1px solid #cc0000'
                }),
                e.preventDefault()));
          }
          u();
          t = p('#product_save_button');
          void 0 !== t && t.attr('disabled', 'disabled');
        }),
        function() {
          var e = !0;
          return (
            p('li a.attributes').length &&
              1 == wcv_frontend_product.require_attributes &&
              (0 < p('.woocommerce_attribute ').length
                ? p('.wcv_attribute_data').each(function() {
                    p(this)
                      .find('.attribute_values')
                      .val()
                      ? (p('.attributes-validation-error').html(''),
                        p('a.tabs-tab.attributes').css('background-color', ''),
                        p('a.tabs-tab.attributes').css('color', ''))
                      : (p('.attributes-validation-error').html(
                          '<span class="wcv_required_form_msg">' +
                            wcv_frontend_product.require_attributes_msg +
                            '</span>'
                        ),
                        p('a.tabs-tab.attributes').css(
                          'background-color',
                          'rgba(150,8,12,.55)'
                        ),
                        p('a.tabs-tab.attributes').css(
                          'color',
                          'rgba(255,255,255,.55)'
                        ),
                        (e = !1));
                  })
                : (p('.attributes-validation-error').html(
                    '<span class="wcv_required_form_msg">' +
                      wcv_frontend_product.require_attributes_msg +
                      '</span><br />'
                  ),
                  p('a.tabs-tab.attributes').css(
                    'background-color',
                    'rgba(150,8,12,.55)'
                  ),
                  p('a.tabs-tab.attributes').css(
                    'color',
                    'rgba(255,255,255,.55)'
                  ),
                  (e = !1))),
            e
          );
        });
    wcv_frontend_product.shipping_system_enabled || p('#shipping').html(''),
      ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(e => {
        p('.wcv-upload-files-input').on(e, function(e) {
          e.preventDefault(), e.stopPropagation();
        });
      }),
      ['dragenter', 'dragover'].forEach(e => {
        p('.wcv-upload-files-input').on(e, function() {
          p(this).addClass('is-dragover');
        });
      }),
      ['dragleave', 'drop'].forEach(e => {
        p('.wcv-upload-files-input').on(e, function() {
          p(this).removeClass('is-dragover');
        });
      });
    function _(e) {
      var t = new FormData();
      t.append('action', 'upload-attachment'),
        t.append('async-upload', e),
        t.append(
          '_wpnonce',
          _wpPluploadSettings.defaults.multipart_params._wpnonce
        );
      let a = 0;
      return (
        p.ajax({
          url: wcv_frontend_product.ajax_url,
          type: 'POST',
          data: t,
          processData: !1,
          contentType: !1,
          dataType: 'json',
          async: !1,
          success: function(e) {
            if (!e.success) throw new Error(e.data.message || 'Unknown error');
            a = e.data.id;
          },
          error: function(e) {
            alert('Error uploading file');
          }
        }),
        a
      );
    }
    p('.product-feat-image-upload .wcv-upload-files-input').on('drop', function(
      e
    ) {
      p(this).addClass('is-uploading');
      e = Array.from(e.originalEvent.dataTransfer.files);
      let t = [];
      e.forEach(e => {
        t.push(_(e));
      }),
        Promise.all(t).then(e => {
          i(), p(this).removeClass('is-uploading');
        }),
        p(this).removeClass('is-uploading');
    }),
      p('.product-feat-image-upload .wcv-browser-file').on('click', function(
        e
      ) {
        return e.preventDefault(), i(), !1;
      }),
      p('.product-imgs-gallery-upload .wcv-upload-files-input').on(
        'drop',
        function(e) {
          p(this).addClass('is-uploading');
          e = Array.from(e.originalEvent.dataTransfer.files);
          let t = [];
          e.forEach(e => {
            t.push(_(e));
          }),
            Promise.all(t).then(e => {
              o(), p(this).removeClass('is-uploading');
            }),
            p(this).removeClass('is-uploading');
        }
      ),
      p('.wcv-exporter-wrapper .select2').select2();
  });
}),
  document.addEventListener('DOMContentLoaded', function() {
    let t = () => {
        var e = document.querySelectorAll('.wcv_variation_checkbox');
        let t = 0,
          a = !1;
        e.forEach(e => {
          e.checked && t++;
        });
        var i = document.querySelectorAll('.attribute_values');
        for (let e = 0; e < i.length; e++)
          if (i[e].value) {
            a = !0;
            break;
          }
        0 < t && a
          ? (document
              .getElementById('wcv-attr-message')
              .classList.add('hide-all'),
            document.querySelectorAll('.variations-toolbar').forEach(e => {
              e.classList.remove('hide-all');
            }))
          : (document
              .getElementById('wcv-attr-message')
              .classList.remove('hide-all'),
            document.querySelectorAll('.variations-toolbar').forEach(e => {
              e.classList.add('hide-all');
            }));
      },
      a = () => {
        document.querySelectorAll('.wcv_variation_checkbox').forEach(e => {
          e.removeEventListener('change', t), e.addEventListener('change', t);
        });
      };
    var e = document.getElementById('attributes');
    e &&
      (t(),
      a(),
      new MutationObserver(e => {
        e.forEach(e => {
          'childList' === e.type && (a(), t());
        });
      }).observe(e, { childList: !0, subtree: !0 }));
    let i = e => {
      var t,
        a,
        i = document.getElementById('product-imgs-gallery-upload');
      i &&
        ((t = getComputedStyle(i).paddingLeft),
        (e = document.getElementById(e)),
        (e = getComputedStyle(e)),
        (t = Math.round(i.clientWidth) - parseFloat(t)),
        (a =
          (a = parseFloat(e.gridTemplateColumns.split(' ')[0])) *
            (t = Math.floor(t / a)) +
          (parseFloat(e.columnGap) || 0) * (t - 1)),
        (document.getElementById('product-imgs-gallery-parent').style.width =
          a + 'px'),
        window.innerWidth < 768) &&
        (i.classList.remove('wcv-flex-end'),
        i.classList.add('wcv-flex-center'));
    };
    i('product_images'),
      window.addEventListener('resize', function() {
        i('product_images');
      });
  });
