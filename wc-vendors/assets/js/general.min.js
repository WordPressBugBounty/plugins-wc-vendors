jQuery(function(c) {
  window.Parsley.addValidator('price', {
    validateString: function(e) {
      var n = !0,
        t = wcv_frontend_general.thousand_separator,
        a = wcv_frontend_general.decimal_separator,
        i = wcv_frontend_general.digits_after_decimal,
        r = e.split(a);
      return (
        !(-1 < e.indexOf(t) || 1 < o(e, a)) &&
        (c.each(r, function(e, t) {
          return isNaN(t) ||
            (1 < r.length &&
              e === r.length - 1 &&
              (0 === t.length || i < t.length))
            ? (n = !1)
            : void 0;
        }),
        n)
      );
    },
    messages: { en: wcv_frontend_general.invalid_price_format }
  }),
    window.Parsley.addValidator('decimal', {
      validateString: function(e) {
        var n = !0,
          a = e.split('.');
        return (
          !(1 < o(e, '.')) &&
          (c.each(a, function(e, t) {
            return isNaN(t) ||
              (1 < a.length && e === a.length - 1 && 0 === t.length)
              ? (n = !1)
              : void 0;
          }),
          n)
        );
      },
      messages: { en: wcv_frontend_general.invalid_number_format }
    });
  var o = function(e, t) {
    for (var n = 0, a = 0; a < e.length; a++) e.charAt(a) == t && (n += 1);
    return n;
  };
  function e(e, t) {
    c(e).is(':checked')
      ? (t.prop('disabled', !0),
        t.each(function() {
          c(this).is(':checkbox')
            ? c(this).removeAttr('checked')
            : c(this).val('');
        }))
      : t.prop('disabled', !1);
  }
  c('.wcv-img-id').each(function() {
    var o = this.id;
    c('.wcv-file-uploader-add' + o).on('click', function(e) {
      var t, n, a, i, r;
      return (
        e.preventDefault(),
        (i = c('#' + (t = o))),
        (r = i.data('type')),
        (e = ''),
        'document' === r ? (e = 'application') : 'input' !== r && (e = r),
        (n = wp.media({
          title: i.data('window_title'),
          button: { text: i.data('save_button') },
          library: { type: e },
          multiple: !1
        })).on('select', function() {
          var e;
          (a = n
            .state()
            .get('selection')
            .first()
            .toJSON()),
            c.trim(a.url.length) < 0 ||
              (i.val(a.id).change(),
              c('.wcv-file-uploader-add' + t).addClass('hidden'),
              c('.wcv-file-uploader-delete' + t).removeClass('hidden'),
              'image' === r
                ? ((e = (a.sizes.thumbnail || a).url),
                  c('.wcv-file-uploader' + t).append(
                    '<img src="' +
                      e +
                      '" alt="' +
                      a.caption +
                      '" title="' +
                      a.title +
                      '" style="max-width: 100%; margin-bottom: 16px;" />'
                  ))
                : 'video' === r || 'audio' === r || 'document' === r
                ? ((e = {
                    action: 'wcv_file_uploader_preview',
                    file_url: a.url
                  }),
                  c.post(wcv_frontend_general.ajax_url, e, function(e) {
                    c('.wcv-file-uploader' + t).append(e);
                  }))
                : c('.wcv-file-uploader' + t).append(
                    '<div class="control-group"><div class="control"><input type="text" value="' +
                      a.url +
                      '" readonly/></div></div>'
                  ));
        }),
        n.open(),
        !1
      );
    }),
      c('.wcv-file-uploader-delete' + o).on('click', function(e) {
        e.preventDefault(),
          c('.wcv-file-uploader' + o).html(''),
          c('input[id=' + o + ']').val(''),
          c('.wcv-file-uploader-delete' + o).addClass('hidden'),
          c('.wcv-file-uploader-reset' + o).addClass('hidden'),
          c('.wcv-file-uploader-add' + o).removeClass('hidden');
      });
  }),
    c('select#_wcv_shipping_from')
      .on('change', function() {
        'other' === c(this).val()
          ? c('.shipping_other').show()
          : c('.shipping_other').hide();
      })
      .trigger('change'),
    c('#_wcv_shipping_fee_national_free').on('change', function() {
      e(c(this), c('#_wcv_shipping_fee_national'));
    }),
    c('#_wcv_shipping_fee_national_disable').on('change', function() {
      e(c(this), c('.wcv-disable-national-input'));
    }),
    c('#_wcv_shipping_fee_international_free').on('change', function() {
      e(c(this), c('#_wcv_shipping_fee_international'));
    }),
    c('#_wcv_shipping_fee_international_disable').on('change', function() {
      e(c(this), c('.wcv-disable-international-input'));
    }),
    'other' === c('#_wcv_shipping_from').val()
      ? c('.shipping_other').show()
      : c('.shipping_other').hide(),
    c('.wcv-vacaction-mode').on('change', function() {
      c('.wcv-vacation-mode-msg-wrapper').slideToggle();
    }),
    c('.wcv-vacaction-mode').is(':checked') &&
      c('.wcv-vacation-mode-msg-wrapper').show(),
    c('.wcv-ga-enable').on('change', function() {
      c('.wcv-ga-id-value-wrapper').slideToggle();
    }),
    c('.wcv-ga-enable').is(':checked')
      ? c('.wcv-ga-id-value-wrapper').slideToggle()
      : c('.wcv-ga-id-value-wrapper').hide(),
    c('.wcv-enable-opening-hours').on('change', function() {
      c('.wcv-opening-hours-wrapper').slideToggle();
    }),
    c('.wcv-enable-opening-hours').is(':checked')
      ? c('.wcv-opening-hours-wrapper').show()
      : c('.wcv-opening-hours-wrapper').hide(),
    c('#store_save_button').on('click', function(e) {
      e.preventDefault();
      e = {
        action: 'wcv_json_unique_store_name',
        store_name: c('#_wcv_store_name').val(),
        security: wcv_frontend_general.wcv_json_unique_store_name_nonce
      };
      c.post(wcv_frontend_general.ajax_url, e, function(e) {
        if (e.error) return window.alert(e.error), !1;
        c('#wcv-store-settings').submit();
      });
    }),
    c('.wcv-form').parsley({
      trigger: 'input',
      excluded:
        '.is_hidden, input[type=button], input[type=submit], input[type=reset], input[type=hidden], [disabled]',
      classHandler: function(e) {
        return e.$element.hasClass('wcv_category_check')
          ? e.$element.closest('.wcv_terms_checklist_container')
          : e.$element.hasClass('select2-hidden-accessible')
          ? e.$element.parent().find('.select2-selection')
          : e.$element.hasClass('wcv-datepicker')
          ? e.$element.closest('.wcv-datepicker-wrapper')
          : e;
      },
      errorsContainer: function(e) {
        return e.$element.hasClass('wcv_category_check')
          ? e.$element.closest('.wcv_terms_checklist_container').parent()
          : e.$element.hasClass('select2-hidden-accessible')
          ? e.$element.parent()
          : e.$element.hasClass('wcv-datepicker')
          ? e.$element.closest('.control-group')
          : e;
      }
    }),
    window.Parsley.on('field:error', function() {
      var e = this.$element.closest('.tabs-content').attr('id');
      c('.wcv-tabs')
        .find('.' + e)
        .addClass('tab-has-error');
    }),
    window.Parsley.on('field:success', function() {
      var e = this.$element.closest('.tabs-content');
      0 < e.find('.parsley-error').length ||
        ((e = e.attr('id')),
        c('.wcv-tabs')
          .find('.' + e)
          .removeClass('tab-has-error'));
    }),
    'hidden' === Cookies.get('vendor_store_notice')
      ? c('.woocommerce-store-notice').hide()
      : c('.woocommerce-store-notice').show(),
    c('#clear_button').on('click', function(e) {
      e.preventDefault();
      var e = c('#_wcv_order_start_date_input'),
        t = c('#_wcv_order_end_date_input');
      e.val(e.data('default')),
        t.val(t.data('default')),
        c('#_wcv_shipping_status_input').val(''),
        c('#_wcv_order_status_input').val(''),
        c('.wcv-order-header .wcv-form').trigger('submit');
    }),
    c('#clear_button_commission').on('click', function(e) {
      e.preventDefault();
      var e = c('#_wcv_commission_start_date_input'),
        t = c('#_wcv_commission_end_date_input');
      e.val(e.data('default')),
        t.val(t.data('default')),
        c('.wcv-commission-header .wcv-form').trigger('submit');
    }),
    c('#clear_button_report').on('click', function(e) {
      e.preventDefault();
      var e = c('#_wcv_dashboard_start_date_input'),
        t = c('#_wcv_dashboard_end_date_input');
      e.val(e.data('default')),
        t.val(t.data('default')),
        c('.wcv-form').trigger('submit');
    }),
    c('#clear_button_product').on('click', function(e) {
      e.preventDefault(),
        c('#_wcv_product_category').val(''),
        c('#_wcv_product_tag').val(''),
        c('#_wcv_product_type').val(''),
        c('#wcv-search').val(''),
        c('.wcv-form').trigger('submit');
    }),
    c('select#wcv_paypal_masspay_wallet')
      .on('change', function() {
        'venmo' === c(this).val()
          ? c('.wcv_paypal_masspay_venmo_id').show()
          : c('.wcv_paypal_masspay_venmo_id').hide();
      })
      .trigger('change');
});
